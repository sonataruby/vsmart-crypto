SmartApps=function(c,i){"use strict";var l,p;let u=c.Blockchain;var n,d=u.address();return c.tokenGame1={},c.tokenGame1.getBalt=async()=>{var r=[];return await l.getTokenOwner(n).call().then(async t=>{for(var e=0;e<t.length;e++)await axios.get("https://api.starsbattle.co/layer/"+t[e]).then(a=>{a=a.data,a={tokenId:t[e],name:a.name,Class:a.Class,Lever:a.Lever,Bullet:a.Bullet,BulletClass:a.BulletClass,Speed:a.Speed,Score:a.Score,Groups:a.Groups};r.push(a)})}),0==r.length&&(i.location.href="/app/marketplace"),r},c.tokenGame1.getPlayer=async a=>{var t={};return await axios.get("https://api.starsbattle.co/layer/"+a).then(a=>{t=a.data}),t},c.tokenGame1.upLever=async(a,t,e)=>{let r=0;return await axios.post("https://api.starsbattle.co/uplever",{tokenid:a,score:t,bullet:e,wallet:n}).then(async a=>{"update"==a.data.status&&(a=a.data.hash,await l.upLeverStart(a).send({gas:3e5,data:n}).then(a=>{a.transactionHash&&(r=1)}))}),r},c.tokenGame1.getMarketPlate=async a=>{var r=[];return await p.getMarketStars(a+1).call().then(a=>{for(var t,e=0;e<a.length;e++)0<e&&(t={id:e,name:""!=a[e].name?a[e].name:"Stars CX 1",price:0<a[e].price?u.fromWei(a[e].price):1e3,lever:0<a[e].lever?a[e].lever:1,class:0<a[e].class?a[e].class:1,bullet:0<a[e].bullet?a[e].bullet:1e3,bulletclass:0<a[e].bulletclass?a[e].bulletclass:1,speed:0<a[e].speed?a[e].speed:7},r.push(t))}),r},c.tokenGame1.keccak256=a=>u.keccak256(a),c.tokenGame1.buyMarketPlate=async a=>{var t=(await p.MarketPlaceItemOf(a).call()).price;if(0==t)return u.notify("Item not avalible"),!1;await c.tokenSmart.allowance(d.AddressContractNFTFactory)<t&&await c.tokenSmart.approve(d.AddressContractNFTFactory,t),await p.buyStars(a).send({gas:5e5}).then(a=>{console.log(a)})},c.tokenGame1.getBulletMarket=async a=>{var r=[];return await p.getBulletMarket(a).call().then(a=>{for(var t=0;t<a.length;t++){var e={id:t,name:a[t].name,price:u.fromWei(a[t].price),bullet:a[t].bullet};r.push(e)}}),r},c.tokenGame1.buyBullet=async(t,e,r,l)=>{var a=(await p.MarketPlaceBulletOf(e).call()).price;if(0==a)return u.notify("Item not avalible"),!1;var n=await c.tokenSmart.allowance(d.AddressContractNFTFactory),s=await c.tokenGame1.getPlayer(t),o=Number(s.Bullet);return n<a&&await c.tokenSmart.approve(d.AddressContractNFTFactory,a),await p.MarketPlaceBulletOf(e).call().then(async a=>{0<a.price?await p.buyBullet(t,e,r).send({gas:3e5}).then(async a=>{u.notify("Item Update"),1==l?o=1:(await axios.post("https://api.starsbattle.co/nft",{tokenid:t}),i.location.href="/app/my")}):u.notify("Item not support")}),o},c.tokenGame1.buyVip=async(t,e)=>{var a=(await p.VipOf(e).call()).price;if(0==a)return u.notify("Item not avalible"),!1;await c.tokenSmart.allowance(d.AddressContractNFTFactory)<a&&await c.tokenSmart.approve(d.AddressContractNFTFactory,a),await p.VipOf(e).call().then(async a=>{0<a.id?await p.buyVip(t,e).send({gas:3e5}).then(a=>{u.notify("VIP Update")}):u.notify("VIP Item not support")})},c.tokenGame1.Init=async()=>{await u.init(),l=await u.loadContractGame1(),p=await u.loadContractNFTFactory(),n=await u.getLoginWallet()},c.components.docReady.push(c.tokenGame1.Init),c}(SmartApps,(jQuery,window));